(function(){"use strict";var e={2399:function(e,t,n){var i=n(9242),l=n(3396);function s(e,t,n,i,s,o){const d=(0,l.up)("EditMode"),r=(0,l.up)("ViewMode");return(0,l.wg)(),(0,l.iD)("main",null,["edit"===s.mode?((0,l.wg)(),(0,l.j4)(d,{key:0,elements:s.elements,links:s.links,onCreateLinkedElement:o.createLinkedElement,onDeleteElement:o.deleteElement,onClear:o.clear,onLinkElements:o.linkElements,onDeleteLink:o.deleteLink,onViewMode:t[0]||(t[0]=e=>s.mode="view")},null,8,["elements","links","onCreateLinkedElement","onDeleteElement","onClear","onLinkElements","onDeleteLink"])):((0,l.wg)(),(0,l.j4)(r,{key:1,elements:s.elements,links:s.links,onEditMode:t[1]||(t[1]=e=>s.mode="edit")},null,8,["elements","links"]))])}n(7658);var o=n(7139);const d={class:"edit-mode"},r={class:"area"},m=["x1","x2","y1","y2","onClick"],a={class:"elements"},c={class:"panel"},u=(0,l._)("label",null,"Title",-1),h=(0,l._)("p",null,[(0,l._)("textarea",{id:"editor"})],-1),k={key:0},f=["onUpdate:modelValue"];function g(e,t,n,s,g,E){const v=(0,l.up)("EditModeElement");return(0,l.wg)(),(0,l.iD)("div",d,[(0,l._)("nav",null,[(0,l._)("button",{onClick:t[0]||(t[0]=t=>e.$emit("viewMode"))},"View mode"),(0,l._)("button",{onClick:t[1]||(t[1]=t=>e.$emit("clear"))},"Clear")]),(0,l._)("div",r,[((0,l.wg)(),(0,l.iD)("svg",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.links,(e=>((0,l.wg)(),(0,l.iD)("line",{x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2,key:e.id,class:(0,o.C_)({selected:e.selected}),onClick:t=>E.selectLink(e)},null,10,m)))),128))])),(0,l._)("div",a,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.elements,(t=>((0,l.wg)(),(0,l.j4)(v,{key:t.id,element:t,onDeleteElement:n=>e.$emit("deleteElement",t),onCreateLinkedElement:e=>E.createLinkedElement(e,t),onLinking:e=>E.linking(e,t),onMovestart:e=>E.movestart(e,t),onSelectElement:e=>E.selectElement(t)},null,8,["element","onDeleteElement","onCreateLinkedElement","onLinking","onMovestart","onSelectElement"])))),128))])]),(0,l.wy)((0,l._)("div",c,[(0,l._)("p",null,[u,(0,l.wy)((0,l._)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>E.selectedElement.title=e)},null,512),[[i.nr,E.selectedElement.title]])]),h,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(E.selectedElement.nodes,(e=>((0,l.wg)(),(0,l.iD)(l.HY,{key:e.id},[e.linkId?((0,l.wg)(),(0,l.iD)("p",k,[(0,l._)("label",null,"Node "+(0,o.zw)(e.id),1),(0,l.wy)((0,l._)("input",{type:"text","onUpdate:modelValue":t=>e.title=t},null,8,f),[[i.nr,e.title]])])):(0,l.kq)("",!0)],64)))),128))],512),[[i.F8,E.selectedElement.id]])])}const E=["onMouseup"];function v(e,t,n,i,s,d){return(0,l.wg)(),(0,l.iD)("div",{class:"element",onMousedown:t[2]||(t[2]=t=>e.$emit("movestart",t)),style:(0,o.j5)({top:`${n.element.y}px`,left:`${n.element.x}px`})},[(0,l._)("div",{class:(0,o.C_)(["nodes",{selected:n.element.selected}])},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.element.nodes,(e=>((0,l.wg)(),(0,l.iD)("div",{class:(0,o.C_)(["node",`node-${e.id} ${e.linkId||e.linking?"active":""}`]),key:e.id,onMouseup:t=>d.mouseup(t,e)},[(0,l._)("span",null,(0,o.zw)(e.id),1)],42,E)))),128))],2),(0,l._)("button",{class:"edit",onClick:t[0]||(t[0]=t=>e.$emit("selectElement"))},"E"),(0,l._)("button",{class:"delete",onClick:t[1]||(t[1]=t=>e.$emit("deleteElement"))},"X")],36)}var w={name:"EditModeElement",props:["element"],data(){return{dragging:!1,startOffset:{x:0,y:0}}},methods:{mouseup:function(e,t){t.linkId||(e.shiftKey?this.$emit("linking",t):this.$emit("createLinkedElement",t))}},mounted(){}},p=n(89);const y=(0,p.Z)(w,[["render",v]]);var b=y,_={name:"EditMode",props:["elements","links"],components:{EditModeElement:b},data(){return{draggingElement:null,draggingState:!1,startOffset:{x:0,y:0},linkingState:{from:{element:null,node:null},to:{element:null,node:null}}}},watch:{selectedElement:function(){window.CKEDITOR.instances.editor.setData(this.selectedElement.content||"")}},computed:{selectedElement:function(){return this.elements.find((e=>e.selected))||{}}},methods:{createLinkedElement:function(e,t){this.draggingState||this.$emit("createLinkedElement",t,e)},linking:function(e,t){this.draggingState||(this.linkingState.from.element?this.linkingState.to={element:t,node:e}:this.linkingState.from={element:t,node:e},e.linking=!0,this.linkingState.from.element&&this.linkingState.to.element&&(this.$emit("linkElements",this.linkingState),this.linkingState.from.node.linking=!1,this.linkingState.to.node.linking=!1,this.linkingState={from:{element:null,node:null},to:{element:null,node:null}}))},movestart:function(e,t){this.draggingElement=t,this.startOffset={x:e.x-t.x,y:e.y-t.y}},move:function(e){this.draggingElement&&(this.draggingState=!0,this.draggingElement.x=e.x-this.startOffset.x,this.draggingElement.y=e.y-this.startOffset.y)},moveend:function(){this.draggingElement=null,this.draggingState=!1},isWysiwygareaAvailable:function(){return"%REV%"==window.CKEDITOR.revision||!!window.CKEDITOR.plugins.get("wysiwygarea")},updateElement:function(e){this.selectedElement=Object.assign(this.selectedElement,e)},deselect:function(){this.elements.forEach((e=>e.selected=!1)),this.links.forEach((e=>e.selected=!1))},selectElement:function(e){this.deselect(),e.selected=!0},selectLink:function(e){this.deselect(),e.selected=!0}},updated(){this.selectedElement.id&&(this.selectedElement.content=window.CKEDITOR.instances.editor.getData())},mounted(){document.onmousemove=e=>this.move(e),document.onmouseup=this.moveend,document.onkeydown=e=>{"Delete"!==e.key&&"Backspace"!==e.key||this.$emit("deleteLink")},document.querySelector("svg").onclick=e=>{"line"!==e.target.nodeName&&this.deselect()};const e=document.getElementById("editor");this.isWysiwygareaAvailable()?window.CKEDITOR.replace("editor",{removePlugins:["easyimage","cloudservices"]}):(e.setAttribute("contenteditable","true"),window.CKEDITOR.inline("editor",{removePlugins:["easyimage","cloudservices"]}))}};const x=(0,p.Z)(_,[["render",g]]);var I=x;const D={key:0,class:"view"},L=["onClick"],C=["innerHTML"],O={class:"breadcrumbs"},S=["onClick"],M=(0,l.Uk)(" / ");function $(e,t,n,s,d,r){return(0,l.wg)(),(0,l.iD)("div",null,[d.activeElement?((0,l.wg)(),(0,l.iD)("div",D,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.activeElement.nodes,(e=>((0,l.wg)(),(0,l.iD)("div",{class:(0,o.C_)(["view-link",`view-link-${e.id}`]),key:e.id},[e.linkId?((0,l.wg)(),(0,l.iD)("a",{key:0,href:"#",onClick:(0,i.iM)((t=>r.goTo(e)),["prevent"])},(0,o.zw)(e.title),9,L)):(0,l.kq)("",!0)],2)))),128)),(0,l._)("div",{class:(0,o.C_)(["view-element",d.sliding])},[(0,l._)("h3",null,(0,o.zw)(d.activeElement.title),1),(0,l._)("div",{innerHTML:d.activeElement.content},null,8,C)],2)])):(0,l.kq)("",!0),(0,l._)("div",O,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.breadbrumbs,(e=>((0,l.wg)(),(0,l.iD)("div",{key:e.id},[(0,l._)("a",{href:"#",onClick:t=>d.activeElement=e},(0,o.zw)(e.title),9,S),M])))),128))]),(0,l._)("button",{onClick:t[0]||(t[0]=t=>e.$emit("editMode"))},"Edit mode")])}var T={name:"ViewMode",props:["elements","links"],data(){return{activeElement:null,sliding:null,breadbrumbs:[]}},methods:{goTo:function(e){let t=this.links.find((t=>t.id===e.linkId));this.activeElement=this.activeElement.id===t.from.element.id?this.elements.find((e=>e.id===t.to.element.id)):this.elements.find((e=>e.id===t.from.element.id)),this.sliding=`sliding-${e.id}`,this.breadbrumbs.length>1&&this.breadbrumbs[this.breadbrumbs.length-2].id===this.activeElement.id?this.breadbrumbs.splice(this.breadbrumbs.length-1,1):this.breadbrumbs.push(this.activeElement)}},mounted(){this.elements.length&&(this.activeElement=this.elements[0],this.breadbrumbs.push(this.activeElement))}};const K=(0,p.Z)(T,[["render",$],["__scopeId","data-v-7457f2c8"]]);var j=K;const H=100,V={1:{x:0,y:-1*H*1.5},2:{x:1.5*H,y:0},3:{x:0,y:1.5*H},4:{x:-1*H*1.5,y:0}},R={1:3,2:4,3:1,4:2},Y={1:{x:H/2,y:0},2:{x:H,y:H/2},3:{x:H/2,y:H},4:{x:0,y:H/2}};var N={name:"App",components:{EditMode:I,ViewMode:j},data(){return{mode:"edit",elements:[],links:[]}},watch:{elements:{deep:!0,handler:function(){this.links.forEach((e=>{e.x1=e.from.element.x+Y[e.from.node.id].x,e.y1=e.from.element.y+Y[e.from.node.id].y,e.x2=e.to.element.x+Y[e.to.node.id].x,e.y2=e.to.element.y+Y[e.to.node.id].y})),localStorage.setItem("_elements_wsk1029",JSON.stringify(this.elements))}},links:{deep:!0,handler:function(){this.elements.forEach((e=>{e.nodes.forEach((e=>{e.linkId&&!this.links.find((t=>t.id===e.linkId))&&(e.linkId=null)}))})),localStorage.setItem("_links_wsk1029",JSON.stringify(this.links.map((e=>({id:e.id,from:{elementId:e.from.element.id,nodeId:e.from.node.id},to:{elementId:e.to.element.id,nodeId:e.to.node.id}})))))}}},methods:{createElement:function(e){let t=Object.assign({},{id:Date.now(),title:"Lorem ipsum",content:"Lorem ipsum",x:window.innerWidth/2-H/2,y:window.innerHeight/2-H/2,selected:!1,nodes:[{id:1,linkId:null,title:"Lorem ipsum"},{id:2,linkId:null,title:"Lorem ipsum"},{id:3,linkId:null,title:"Lorem ipsum"},{id:4,linkId:null,title:"Lorem ipsum"}]},e);return this.elements.push(t),t},createLink:function(e,t,n,i){let l={id:Date.now(),from:{element:e,node:n},to:{element:t,node:i}};return n.linkId=l.id,i.linkId=l.id,this.links.push(l),l},createLinkedElement:function(e,t){let n=this.createElement({x:e.x+V[t.id].x,y:e.y+V[t.id].y});this.createLink(e,n,t,n.nodes.find((e=>e.id===R[t.id])))},linkElements:function(e){this.createLink(e.from.element,e.to.element,e.from.node,e.to.node)},deleteElement:function(e){e.nodes.forEach((e=>{e.linkId&&this.links.splice(this.links.findIndex((t=>t.id===e.linkId)),1)})),this.elements.splice(this.elements.findIndex((t=>t.id===e.id)),1)},clear:function(){this.elements=[],this.links=[],this.createElement({selected:!0})},deleteLink:function(){this.links=this.links.filter((e=>!e.selected))}},mounted(){localStorage.getItem("_elements_wsk1029")&&(this.elements=JSON.parse(localStorage.getItem("_elements_wsk1029"))||[],this.links=(JSON.parse(localStorage.getItem("_links_wsk1029"))||[]).map((e=>{let t=this.elements.find((t=>t.id===e.from.elementId)),n=this.elements.find((t=>t.id===e.to.elementId));return{id:e.id,from:{element:t,node:t.nodes.find((t=>t.id===e.from.nodeId))},to:{element:n,node:n.nodes.find((t=>t.id===e.to.nodeId))}}}))),this.$nextTick((()=>{this.elements.length||this.clear()}))}};const z=(0,p.Z)(N,[["render",s]]);var q=z;(0,i.ri)(q).mount("#app")}},t={};function n(i){var l=t[i];if(void 0!==l)return l.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(t,i,l,s){if(!i){var o=1/0;for(a=0;a<e.length;a++){i=e[a][0],l=e[a][1],s=e[a][2];for(var d=!0,r=0;r<i.length;r++)(!1&s||o>=s)&&Object.keys(n.O).every((function(e){return n.O[e](i[r])}))?i.splice(r--,1):(d=!1,s<o&&(o=s));if(d){e.splice(a--,1);var m=l();void 0!==m&&(t=m)}}return t}s=s||0;for(var a=e.length;a>0&&e[a-1][2]>s;a--)e[a]=e[a-1];e[a]=[i,l,s]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,i){var l,s,o=i[0],d=i[1],r=i[2],m=0;if(o.some((function(t){return 0!==e[t]}))){for(l in d)n.o(d,l)&&(n.m[l]=d[l]);if(r)var a=r(n)}for(t&&t(i);m<o.length;m++)s=o[m],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(a)},i=self["webpackChunk_01_client"]=self["webpackChunk_01_client"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=n.O(void 0,[998],(function(){return n(2399)}));i=n.O(i)})();
//# sourceMappingURL=app.9b5832cc.js.map